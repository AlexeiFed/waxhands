# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—é —Å–µ—Ä–≤–µ—Ä–∞ waxhands.ru

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
- [–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)](#–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ-–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ-—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- [–†—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ](#—Ä—É—á–Ω–æ–µ-–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞-–Ω–∞-—Å–µ—Ä–≤–µ—Ä–µ)
- [–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º](#—Ä–µ—à–µ–Ω–∏–µ-–ø—Ä–æ–±–ª–µ–º)

---

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (–æ–¥–∏–Ω —Å–∫—Ä–∏–ø—Ç)
```powershell
# –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ (backend + frontend)
.\update-server.ps1 -Component all

# –û–±–Ω–æ–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ backend
.\update-server.ps1 -Component backend

# –û–±–Ω–æ–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ frontend
.\update-server.ps1 -Component frontend
```

---

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

### 1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ PowerShell —Å–∫—Ä–∏–ø—Ç–∞

**–°–∫—Ä–∏–ø—Ç**: `update-server.ps1` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**:
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–±–æ—Ä–∫–∞ –∏ –¥–µ–ø–ª–æ–π
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—à–∏–±–æ–∫ –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ
- ‚úÖ –¶–≤–µ—Ç–Ω–æ–π –≤—ã–≤–æ–¥ –¥–ª—è –ª–µ–≥–∫–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∞—Ä—Ö–∏–≤–æ–≤
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π

**–ö–æ–º–∞–Ω–¥—ã**:

```powershell
# –ü–æ–ª–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (backend + frontend)
.\update-server.ps1 -Component all

# –¢–æ–ª—å–∫–æ backend
.\update-server.ps1 -Component backend

# –¢–æ–ª—å–∫–æ frontend
.\update-server.ps1 -Component frontend
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç**:

#### Backend:
1. –°–±–æ—Ä–∫–∞ TypeScript –≤ JavaScript (`npm run build`)
2. –°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞ `backend-update-YYYYMMDD-HHmmss.zip`
3. –ó–∞–≥—Ä—É–∑–∫–∞ –∞—Ä—Ö–∏–≤–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä —á–µ—Ä–µ–∑ SCP
4. –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
5. –†–∞—Å–ø–∞–∫–æ–≤–∫–∞ –Ω–æ–≤–æ–≥–æ –∞—Ä—Ö–∏–≤–∞ –≤ `dist/`
6. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ PM2 –ø—Ä–æ—Ü–µ—Å—Å–∞
7. –ü–æ–∫–∞–∑ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ª–æ–≥–æ–≤
8. –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –ª–æ–∫–∞–ª—å–Ω—ã—Ö –∞—Ä—Ö–∏–≤–æ–≤ (–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3)

#### Frontend:
1. –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö –∫—ç—à–µ–π (`dist/`, `*.tsbuildinfo`)
2. –°–±–æ—Ä–∫–∞ React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (`npm run build`)
3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ JS —Ñ–∞–π–ª–∞
4. –°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞ `frontend-update-YYYYMMDD-HHmmss.zip`
5. –ó–∞–≥—Ä—É–∑–∫–∞ –∞—Ä—Ö–∏–≤–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä —á–µ—Ä–µ–∑ SCP
6. **–ü–û–õ–ù–ê–Ø –æ—á–∏—Å—Ç–∫–∞** frontend –ø–∞–ø–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (`rm -rf *`)
7. –†–∞—Å–ø–∞–∫–æ–≤–∫–∞ –Ω–æ–≤–æ–≥–æ –∞—Ä—Ö–∏–≤–∞
8. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ Nginx
9. –ü–æ–∫–∞–∑ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –Ω–æ–≤–æ–º JS —Ñ–∞–π–ª–µ
10. –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –ª–æ–∫–∞–ª—å–Ω—ã—Ö –∞—Ä—Ö–∏–≤–æ–≤ (–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3)

---

## –†—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

### Backend

#### –®–∞–≥ 1: –°–±–æ—Ä–∫–∞
```powershell
cd backend
npm run build
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –°–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ `backend/dist/`

#### –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞
```powershell
# –°–æ–∑–¥–∞–µ–º –∞—Ä—Ö–∏–≤ –¢–û–õ–¨–ö–û dist –ø–∞–ø–∫–∏
$timestamp = Get-Date -Format "yyyyMMdd-HHmmss"
Compress-Archive -Path "dist\*" -DestinationPath "backend-update-$timestamp.zip" -Force
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –§–∞–π–ª `backend-update-YYYYMMDD-HHmmss.zip`

#### –®–∞–≥ 3: –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
```powershell
# –ù–∞–π—Ç–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∞—Ä—Ö–∏–≤
$latest = Get-ChildItem -Filter "backend-update-*.zip" | Sort-Object LastWriteTime -Descending | Select-Object -First 1

# –ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä
scp $latest.FullName root@147.45.161.83:/tmp/backend-update.zip
```

#### –®–∞–≥ 4: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
```bash
ssh root@147.45.161.83

# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –ø–∞–ø–∫—É backend
cd /var/www/waxhands-app/backend

# –°–æ–∑–¥–∞–µ–º —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é
cp -r dist dist.backup

# –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ —Ñ–∞–π–ª—ã
rm -rf dist

# –†–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ–º –Ω–æ–≤—ã–π –∞—Ä—Ö–∏–≤
unzip -q /tmp/backend-update.zip -d dist

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º backend
pm2 restart waxhands-backend

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–æ–≥–∏
pm2 logs waxhands-backend --lines 10 --nostream
```

#### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∫–∞
```bash
# –°—Ç–∞—Ç—É—Å PM2
pm2 status

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ –ª–æ–≥–∏
pm2 logs waxhands-backend --lines 20 --nostream

# –ü—Ä–æ–≤–µ—Ä–∫–∞ API
curl -I https://waxhands.ru/api/health
```

---

### Frontend

#### –®–∞–≥ 1: –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–µ–π
```powershell
# –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û! –û—á–∏—â–∞–µ–º –≤—Å–µ –∫—ç—à–∏ –ø–µ—Ä–µ–¥ —Å–±–æ—Ä–∫–æ–π
Remove-Item -Recurse -Force dist -ErrorAction SilentlyContinue
Remove-Item -Force *.tsbuildinfo -ErrorAction SilentlyContinue
Remove-Item -Force backend\*.tsbuildinfo -ErrorAction SilentlyContinue
```

#### –®–∞–≥ 2: –°–±–æ—Ä–∫–∞
```powershell
npm run build
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –°–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ `dist/`

#### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤
```powershell
# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Å–æ–∑–¥–∞–ª—Å—è –ù–û–í–´–ô JS —Ñ–∞–π–ª
dir dist\assets\index-*.js

# –ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å—Ç–∞—Ä–æ–≥–æ —Ñ–∞–π–ª–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, index-BEWE0pAD.js)
# –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–æ–≤—ã–π —Ñ–∞–π–ª —Å –¥—Ä—É–≥–∏–º —Ö–µ—à–æ–º
```

**‚ö†Ô∏è –í–ê–ñ–ù–û**: –ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ —Å—Ç–∞—Ä—ã–π —Ñ–∞–π–ª - –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ –®–∞–≥ 1 –∏ 2!

#### –®–∞–≥ 4: –°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞
```powershell
$timestamp = Get-Date -Format "yyyyMMdd-HHmmss"
Compress-Archive -Path "dist\*" -DestinationPath "frontend-update-$timestamp.zip" -Force
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –§–∞–π–ª `frontend-update-YYYYMMDD-HHmmss.zip`

#### –®–∞–≥ 5: –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
```powershell
# –ù–∞–π—Ç–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∞—Ä—Ö–∏–≤
$latest = Get-ChildItem -Filter "frontend-update-*.zip" | Sort-Object LastWriteTime -Descending | Select-Object -First 1

# –ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä
scp $latest.FullName root@147.45.161.83:/tmp/frontend-update.zip
```

#### –®–∞–≥ 6: –ü–û–õ–ù–û–ï –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
```bash
ssh root@147.45.161.83

# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –ø–∞–ø–∫—É frontend
cd /var/www/waxhands-app/frontend

# –ü–û–õ–ù–ê–Ø –æ—á–∏—Å—Ç–∫–∞ (–ö–†–ò–¢–ò–ß–ù–û!)
rm -rf *

# –†–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ–º –Ω–æ–≤—ã–π –∞—Ä—Ö–∏–≤
unzip -q /tmp/frontend-update.zip -d .

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º Nginx
systemctl reload nginx

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–æ–≤—ã–π JS —Ñ–∞–π–ª
ls -la assets/index-*.js | tail -1
```

**‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ù–û**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `rm -rf *` –≤–º–µ—Å—Ç–æ `rm -rf assets` –¥–ª—è –ü–û–õ–ù–û–ô –æ—á–∏—Å—Ç–∫–∏!

#### –®–∞–≥ 7: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
1. –û—Ç–∫—Ä–æ–π—Ç–µ https://waxhands.ru
2. –ù–∞–∂–º–∏—Ç–µ **Ctrl+F5** (–∏–ª–∏ Ctrl+Shift+R) –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –∫—ç—à–∞ –±—Ä–∞—É–∑–µ—Ä–∞
3. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12) ‚Üí Network
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è **–ù–û–í–´–ô** JS —Ñ–∞–π–ª —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Ö–µ—à–µ–º

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```
/var/www/waxhands-app/
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ dist/               # –°–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ JS —Ñ–∞–π–ª—ã (–¥–µ–ø–ª–æ—è—Ç—Å—è)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ controllers/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.js
‚îÇ   ‚îú‚îÄ‚îÄ dist.backup/        # –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è (—Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
‚îÇ   ‚îú‚îÄ‚îÄ uploads/            # –ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–ù–ï –¥–µ–ø–ª–æ—è—Ç—Å—è)
‚îÇ   ‚îú‚îÄ‚îÄ node_modules/       # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–ù–ï –¥–µ–ø–ª–æ—è—Ç—Å—è)
‚îÇ   ‚îú‚îÄ‚îÄ .env                # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–ù–ï –¥–µ–ø–ª–æ—è—Ç—Å—è)
‚îÇ   ‚îî‚îÄ‚îÄ package.json
‚îÇ
‚îú‚îÄ‚îÄ frontend/
‚îÇ   ‚îú‚îÄ‚îÄ assets/             # JS, CSS, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–¥–µ–ø–ª–æ—è—Ç—Å—è)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index-HASH.js
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index-HASH.css
‚îÇ   ‚îú‚îÄ‚îÄ uploads/            # –ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (–ù–ï –¥–µ–ø–ª–æ—è—Ç—Å—è)
‚îÇ   ‚îú‚îÄ‚îÄ index.html          # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (–¥–µ–ø–ª–æ–∏—Ç—Å—è)
‚îÇ   ‚îî‚îÄ‚îÄ .env                # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–ù–ï –¥–µ–ø–ª–æ—è—Ç—Å—è)
‚îÇ
‚îî‚îÄ‚îÄ websocket-server-simple.js  # –û—Ç–¥–µ–ª—å–Ω—ã–π WebSocket —Å–µ—Ä–≤–µ—Ä

–í–ê–ñ–ù–û:
- backend/dist/ - –ü–û–õ–ù–û–°–¢–¨–Æ –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –¥–µ–ø–ª–æ–µ
- frontend/* - –ü–û–õ–ù–û–°–¢–¨–Æ –æ—á–∏—â–∞–µ—Ç—Å—è –∏ –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –¥–µ–ø–ª–æ–µ
- uploads/ - –ù–ï —Ç—Ä–æ–≥–∞—é—Ç—Å—è –ø—Ä–∏ –¥–µ–ø–ª–æ–µ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ñ–∞–π–ª—ã)
- .env - –ù–ï —Ç—Ä–æ–≥–∞—é—Ç—Å—è –ø—Ä–∏ –¥–µ–ø–ª–æ–µ (–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞)
```

---

## –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### Backend –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

**–ü—Ä–æ–±–ª–µ–º–∞**: PM2 –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å "errored" –∏–ª–∏ "stopped"

**–†–µ—à–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
pm2 logs waxhands-backend --lines 50

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º –æ–∫—Ä—É–∂–µ–Ω–∏—è
pm2 restart waxhands-backend --update-env

# –ï—Å–ª–∏ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç - –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ backup
cd /var/www/waxhands-app/backend
rm -rf dist
cp -r dist.backup dist
pm2 restart waxhands-backend
```

### Frontend –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è (—Å—Ç–∞—Ä—ã–π JS —Ñ–∞–π–ª –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è)

**–ü—Ä–æ–±–ª–µ–º–∞**: –í–∏–¥–∏—Ç–µ —Å—Ç–∞—Ä—ã–π `index-BEWE0pAD.js` –≤–º–µ—Å—Ç–æ –Ω–æ–≤–æ–≥–æ

**–ü—Ä–∏—á–∏–Ω–∞**: –ö—ç—à –Ω–µ –±—ã–ª –æ—á–∏—â–µ–Ω –∏–ª–∏ –Ω–µ–ø–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

**–†–µ—à–µ–Ω–∏–µ**:

1. **–õ–æ–∫–∞–ª—å–Ω–æ**:
```powershell
# –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –∫—ç—à–µ–π
Remove-Item -Recurse -Force dist
Remove-Item -Force backend\*.tsbuildinfo
Remove-Item -Force *.tsbuildinfo

# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞
npm run build

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞
dir dist\assets\index-*.js
```

2. **–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ**:
```bash
ssh root@147.45.161.83
cd /var/www/waxhands-app/frontend

# –ü–û–õ–ù–ê–Ø –æ—á–∏—Å—Ç–∫–∞
rm -rf *

# –†–∞—Å–ø–∞–∫–æ–≤–∫–∞
unzip -q /tmp/frontend-update.zip -d .

# –ü—Ä–æ–≤–µ—Ä–∫–∞
ls -la assets/index-*.js
```

3. **–í –±—Ä–∞—É–∑–µ—Ä–µ**:
- –ù–∞–∂–º–∏—Ç–µ **Ctrl+Shift+Delete**
- –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à –∑–∞ –≤—Å–µ –≤—Ä–µ–º—è
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **Ctrl+F5** –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ

### –û—à–∏–±–∫–∞ "Too many requests" –Ω–∞ backend

**–ü—Ä–æ–±–ª–µ–º–∞**: Backend –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 429 Too Many Requests

**–†–µ—à–µ–Ω–∏–µ**:
```bash
ssh root@147.45.161.83
pm2 restart waxhands-backend
```

### WebSocket –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

**–ü—Ä–æ–±–ª–µ–º–∞**: –ß–∞—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–µ—Ç real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

**–ü—Ä–æ–≤–µ—Ä–∫–∞**:
```bash
ssh root@147.45.161.83

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Ä—Ç 3002
netstat -tlnp | grep 3002

# –ï—Å–ª–∏ –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç - –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
cd /var/www/waxhands-app
node websocket-server-simple.js &
```

### Nginx –æ—à–∏–±–∫–∏

**–ü—Ä–æ–±–ª–µ–º–∞**: 502 Bad Gateway –∏–ª–∏ 404 Not Found

**–†–µ—à–µ–Ω–∏–µ**:
```bash
ssh root@147.45.161.83

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
systemctl status nginx

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
nginx -t

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å
systemctl reload nginx

# –ï—Å–ª–∏ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç - –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
systemctl restart nginx
```

### SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –∏—Å—Ç–µ–∫

**–ü—Ä–æ–±–ª–µ–º–∞**: –ë—Ä–∞—É–∑–µ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–µ

**–†–µ—à–µ–Ω–∏–µ**:
```bash
ssh root@147.45.161.83

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è
openssl x509 -in /etc/ssl/certs/waxhands.ru.crt -noout -dates

# –û–±–Ω–æ–≤–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Let's Encrypt)
certbot renew --nginx

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å Nginx
systemctl reload nginx
```

---

## Checklist –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

### Backend
- [ ] –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã –≤ Git
- [ ] –¢–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã (–µ—Å–ª–∏ –µ—Å—Ç—å)
- [ ] –ù–µ—Ç –æ—à–∏–±–æ–∫ –ª–∏–Ω—Ç–µ—Ä–∞
- [ ] `.env` —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∞–∫—Ç—É–∞–ª–µ–Ω
- [ ] –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∞ (–µ—Å–ª–∏ –±—ã–ª–∏ –º–∏–≥—Ä–∞—Ü–∏–∏)

### Frontend
- [ ] –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã –≤ Git
- [ ] –ö—ç—à–∏ –æ—á–∏—â–µ–Ω—ã –ø–µ—Ä–µ–¥ —Å–±–æ—Ä–∫–æ–π
- [ ] –ù–æ–≤—ã–π JS —Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º —Ö–µ—à–µ–º
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Ä–∞–±–æ—Ç–∞ –Ω–∞ localhost
- [ ] `.env.production` —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∞–∫—Ç—É–∞–ª–µ–Ω

### –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è
- [ ] Backend –∑–∞–ø—É—Å—Ç–∏–ª—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫ (pm2 status)
- [ ] Frontend –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å –Ω–æ–≤—ã–º JS —Ñ–∞–π–ª–æ–º
- [ ] API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –≤—Å–µ—Ö —Ä–æ–ª–µ–π
- [ ] –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã

---

## –ö–æ–Ω—Ç–∞–∫—Ç—ã

**–°–µ—Ä–≤–µ—Ä**: timeweb.cloud  
**IP**: 147.45.161.83  
**–î–æ–º–µ–Ω**: waxhands.ru  
**SSH**: root@147.45.161.83  

**–ü–æ—Ä—Ç—ã**:
- 80/443: Nginx (HTTP/HTTPS)
- 3001: Backend API
- 3002: WebSocket —Å–µ—Ä–≤–µ—Ä
- 5432: PostgreSQL

**PM2 –ø—Ä–æ—Ü–µ—Å—Å—ã**:
- `waxhands-backend`: –û—Å–Ω–æ–≤–Ω–æ–π backend –ø—Ä–æ—Ü–µ—Å—Å
- `payment-checker`: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π (–º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [.cursorrules](.cursorrules) - –ü—Ä–∞–≤–∏–ª–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- [changelog.md](changelog.md) - –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
- [tasktracker.md](tasktracker.md) - –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á
- [project.md](project.md) - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 2025-11-19  
**–ê–≤—Ç–æ—Ä**: –ê–ª–µ–∫—Å–µ–π

