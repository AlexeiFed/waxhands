Создание скрипта оплаты
В данном разделе описаны настройки разных типов магазинов и нужд вашего бизнеса, создание скрипта оплаты и взаимодействие сервиса с вашим магазином и покупателем.

Для магазина без формирования уникального номера счета (простой магазин)
Такой магазин не может каким-либо способом контролировать процесс получения платежей и вам, скорее всего, придется в ручном режиме проставлять статусы оплаты заказов в магазине и отгружать товар покупателям.

Схема работы
Пользователь, выбрав способ оплаты и нажав кнопку «Оплатить», попадает на страницу robokassa, где производит оплату (на счёт магазина при этом поступают средства в вашей валюте).1

По окончании процесса на e-mail адрес оператора магазина посылается сообщение о произведенной операции.2

Настройки магазина
В разделе Технических настройках необходимо заполнить поля:

Алгоритм расчёта хэша — MD5 (значение по умолчанию).

ResultURL — метод отправки данных – e-mail (e-mail адрес оператора магазина).

SuccessURL – адрес страницы, на которую отправится покупатель после оплаты, метод отправки данных не имеет значения (можно оставить главную страницу сайта, либо разместить по этому адресу страницу с текстом, говорящим клиенту, что его платёж успешно проведён).

FailURL – адрес страницы, на которую направляется покупатель после неудачной оплаты, метод отправки данных не имеет значения (можно оставить главную страницу сайта, либо разместить по этому адресу страницу с текстом, говорящим клиенту, что его платёж не проведён).

Для такого магазина и скрипт необходим самый простой. В принципе необходим даже не скрипт, а ссылка для перехода на совершение оплаты.

Создание ссылки оплаты
Для работы вам понадобится самый простой текстовый редактор, например — Блокнот.

Воспользуемся шаблоном запроса для перехода на оплату и заменим [значение] соответствующими данными.1

https://auth.robokassa.ru/Merchant/Index.aspx?MerchantLogin= [значение] &OutSum= [значение] &Description= [значение] &SignatureValue= [значение]

Параметр

Подставляемые Данные

Комментарий

MerchantLogin
demo
Это ваш ID магазина

OutSum
11
Стоимость товара, ₽

Description
Покупка в демо магазине
Описание покупки

В результате получаем ссылку:
https://auth.robokassa.ru/Merchant/Index.aspx?MerchantLogin=demo&OutSum=11&Description=Покупка в демо магазине&SignatureValue= [значение]

В полученной ссылке отсутствует только последнее значение – SignatureValue
Его необходимо вычислить.2

Строка данных, от которой считают SignatureValue выглядит так:
MerchantLogin:OutSum::Пароль #1

Подставляем в неё соответствующие значения и получаем:
demo:11::[Пароль #1]

Для вычисления Контрольной суммы, SignatureValue, по алгоритму MD5 можно использовать MD5 хэш генератор.

Внимание!
Обратите внимание,что обязательный параметр InvId присутствует в подсчете SignatureValue, хотя и с пустым значением.

Собираем готовую ссылку для размещения на Вашем сайте:3

https://auth.robokassa.ru/Merchant/Index.aspx?MerchantLogin=demo&OutSum=11&Description=Покупка в демо магазине&SignatureValue=2c113e992e2c985e43e348ff3c12f32b

В результате всех этих действий Вы получите ссылку для размещения на своём сайте без какого-либо дополнительного программирования. И начинайте принимать платежи.

Для магазина формирующего уникальный номер счета
Схема работы
Cкрипт магазина, сформировав уникальный номер счета и подпись, направляет пользователя на оплату;1

Robokassa уведомляет магазин, что платёж совершён, вызывая скрипт, находящийся по адресу ResultURL. Скрипту передаются параметры платежа, подписанные Robokassa с использованием Пароля#2.2

Если в момент оповещения между Robokassa и магазином отсутствует связь, сервис будет повторять попытки ещё четыре раза, а в случае неудачи администратору магазина будет отправлен e-mail:

Получена оплата:
Цена: стоимость заказа

Inv_id: номер заказа

Метод оплаты: метод, которым был оплачен заказ

shp_...

С уважением, проект Robokassa

После оплаты пользователь перенаправляется на страницу по адресу SuccessURL – Robokassa передаёт набор параметров с которыми вы можете ознакомиться в разделе "Переадресация при успешной оплате на SuccessURL" .3

Настройки магазина
В разделе Технические настройки необходимо заполнить поля:

Алгоритм расчёта хэша — MD5 (значение по умолчанию).

ResultURL — метод отправки данных – GET или POST (в зависимости от того, запросы какого вида принимает ваш скрипт-обработчик).

SuccessURL – адрес страницы, на которую отправится покупатель после оплаты, метод отправки данных не имеет значения (можно оставить главную страницу сайта, либо разместить по этому адресу страницу с текстом, говорящим клиенту, что его платёж успешно проведён).

FailURL – адрес страницы, на которую направляется покупатель после неудачной оплаты, метод отправки данных не имеет значения (можно оставить главную страницу сайта, либо разместить по этому адресу страницу с текстом, говорящим клиенту, что его платёж не проведён).

Создание ссылки оплаты
Воспользуемся шаблоном запроса для перехода на оплату.Подставим в него все уже имеющиеся у нас в наличии данные, исхода из описания обязательных параметров. Делается это путём замены переменных вида $mrh_login на соответствующие им значения.1

https://auth.robokassa.ru/Merchant/Index.aspx?MerchantLogin= $mrh_login &OutSum= $out_summ &InvoiceID= $inv_id &Description= $inv_desc &SignatureValue= $crc

Параметр

Подставляемые Данные

Комментарий

$mrh_login
demo
Это ваш ID магазина

$out_summ
11
Стоимость товара, ₽

$inv_id
0
Уникальный номер заказа в Вашем магазине. Указываем именно ноль

$inv_desc
Покупка в демо магазине
Описание покупки

В результате получаем ссылку:2
https://auth.robokassa.ru/Merchant/Index.aspx?MerchantLogin=demo&OutSum=11&InvoiceID=0&Description=Покупка в демо магазине&SignatureValue= $crc

В полученной ссылке отсутствует только последнее значение – SignatureValue
Его необходимо вычислить.

Строка данных, от которой его считают выглядит так:
$mrh_login:$out_summ:$inv_id:$mrh_pass1

Подставляем в неё соответствующие значения и получаем:
demo:11:0:Пароль#1

Пароль/#1 – Это пароль, придуманный вами при заполнении раздела Технических настройках. . Здесь умышлено не показан реальный пароль.

Для вычисления Контрольной суммы, SignatureValue, по алгоритму MD5 можно использовать один MD5 калькулятор. Теперь берём строку с данными demo:11:0:Пароль#1 и вычисляем по ней Контрольную сумму. (Не забудьте указать правильный пароль!)

Результат для нашего примера: 56f978e24d1b51fa7b5ace90a4f4ba53

Собираем готовую ссылку для размещения на Вашем сайте:3

https://auth.robokassa.ru/Merchant/Index.aspx?MerchantLogin=demo&OutSum=11&InvoiceID=0&Description=Покупка в демо магазине&SignatureValue=56f978e24d1b51fa7b5ace90a4f4ba53

В результате всех этих действий Вы получите ссылку для размещения на своём сайте, без какого-либо дополнительного программирования. И можете начинать принимать платежи.

Для магазина с применением расширенного интерфейса
Использование всех возможностей Robokassa, таких как дополнительные пользовательские параметры и XML-интерфейсы, позволит вам настроить максимально глубокую интеграцию между нашей системой и вашим интернет-магазином. Это позволит обеспечить большую гибкость в использовании Robokassa, и позволит вам обслуживать своих клиентов на качественно новом уровне.

XML-интерфейсы позволяют:
получать список принимаемых валют;

в любой момент времени проверить состояние оплаты заказа. Это даст вам большую стабильность и повышенную безопасность. К примеру, ваша система может перед автоматической выдачей товара проверять состояние оплаты заказа непосредственно у Robokassa.

Передача дополнительных пользовательских параметров, даёт вам возможность настроить работу своего сайта с максимальным комфортом для ваших клиентов и сотрудников. Так использование этих параметров позволит вам распределить денежные потоки внутри своего ресурса относительно тех вариантов услуг или товаров, которые вы продаёте.

Ещё один вариант использования этих параметров – это дополнительная идентификация ваших клиентов, что очень часто бывает необходимо для корректного зачисления платежа.

Для ручной обработки заказов или работы без сайта
Если вы хотите, чтобы клиент мог оплатить счет только после проверки заказа менеджером и согласования с клиентом комплекта поставки, а также если вы не имеете сайта, а работаете, например, по телефону, вам очень сложно разобраться в технических деталях подключения и не требуется программист – вам необходимо использовать следующий вариант работы. В Личном кабинете вам доступен раздел «Выставление счетов», который представляет собой простой и понятный интерфейс по созданию письма клиенту со ссылкой на оплату конкретного заказа, проверенного вашим менеджером и согласованного с клиентом.

Настройка магазина
Зарегистрироваться и создать магазин в Robokassa1

В разделе Технические настройки нужно прописать два пароля (обязательное условие).2

В поле Resutl URL нужно выбрать метод отсылки данных E-Mail и указать электронный почтовый адрес, на который вы планируете получать уведомления об успешных платежах, для дальнейшей обработки их вашими менеджерами. Больше никаких дополнительных настроек не требуется, при условии, что вы планируете работать только в ручном режиме.