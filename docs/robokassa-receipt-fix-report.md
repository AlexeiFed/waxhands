# –û—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –æ—à–∏–±–∫–∏ –≤—ã–¥–∞—á–∏ —á–µ–∫–∞ –†–æ–±–æ–∫–∞—Å—Å—ã

## üìã –ü—Ä–æ–±–ª–µ–º–∞
–ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã –†–æ–±–æ–∫–∞—Å—Å–∞ –Ω–µ —Å–º–æ–≥–ª–∞ –≤—ã–¥–∞—Ç—å —á–µ–∫ - –æ—à–∏–±–∫–∞ –≤—ã–¥–∞—á–∏ —á–µ–∫–∞. –í –ª–æ–≥–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤–∏–¥–Ω–æ:
- –ü–ª–∞—Ç–µ–∂ —É—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω (—Å—Ç–∞—Ç—É—Å `OK1759412423946`)
- –ü–∞—Ä–∞–º–µ—Ç—Ä `Shp_participant` —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–≤–æ–π–Ω–æ–µ URL-–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ (`%25` –≤–º–µ—Å—Ç–æ `%`)
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —á–µ–∫–∞ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –†–æ–±–æ–∫–∞—Å—Å—ã

## üîç –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –î–≤–æ–π–Ω–æ–µ URL-–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ
–í –ø–∞—Ä–∞–º–µ—Ç—Ä–µ `Shp_participant` –±—ã–ª–æ –¥–≤–æ–π–Ω–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ:
```
Shp_participant=%25D0%25B0%25D0%25B2%25D0%25B5%25D0%25BB%2520%25D0%25A2%25D1%258B%25D1%2580%25D0%25B8%25D0%25BD%2520(1%2520%25D0%25B4%25D0%25B5%25D1%2582%25D0%25B5%25D0%25B9)
```
–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```
Shp_participant=%D0%9F%D0%B0%D0%B2%D0%B5%D0%BB%20%D0%A2%D1%8B%D1%80%D0%B8%D0%BD%20(1%20%D0%B4%D0%B5%D1%82%D0%B5%D0%B9)
```

### 2. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —á–µ–∫–∞
–í –∫–æ–¥–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –∑–∞–≥–ª–∞–≤–Ω—ã–µ –∫–ª—é—á–∏ (`Sno`, `Items`, `Name`, `Quantity`, `Sum`, `PaymentMethod`, `PaymentObject`, `Tax`), –∞ —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –†–æ–±–æ–∫–∞—Å—Å—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å—Ç—Ä–æ—á–Ω—ã–µ (`sno`, `items`, `name`, `quantity`, `sum`, `payment_method`, `payment_object`, `tax`).

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —á–µ–∫–∞
**–ë—ã–ª–æ:**
```typescript
const receipt = {
    Sno: 'osn',
    Items: [{
        Name: '–ú–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å "–í–æ—Å–∫–æ–≤–∞—è —Ä—É—á–∫–∞"',
        Quantity: 1,
        Sum: 4.00,
        PaymentMethod: 'full_prepayment',
        PaymentObject: 'service',
        Tax: 'none'
    }]
};
```

**–°—Ç–∞–ª–æ:**
```typescript
const receipt = {
    sno: 'osn',
    items: [{
        name: '–ú–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å "–í–æ—Å–∫–æ–≤–∞—è —Ä—É—á–∫–∞"',
        quantity: 1,
        sum: 4.00,
        cost: 4.00, // –¶–µ–Ω–∞ –∑–∞ –µ–¥–∏–Ω–∏—Ü—É
        payment_method: 'full_payment', // –ü–æ–ª–Ω—ã–π —Ä–∞—Å—á–µ—Ç –¥–ª—è —É—Å–ª—É–≥
        payment_object: 'job', // –†–∞–±–æ—Ç–∞ –¥–ª—è –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å–æ–≤
        tax: 'none',
        nomenclature_code: '04620034587217' // –ù–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞ —Ç–æ–≤–∞—Ä–∞
    }]
};
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞ —Ç–æ–≤–∞—Ä–∞
- **–î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `nomenclature_code`** –¥–ª—è –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤ —Ç–∏–ø–∞—Ö** –¥–ª—è `selectedStyles`, `selectedOptions` –∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å–∞
- **–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –§–ó-54** –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ–¥–ª–µ–∂–∞—â–∏—Ö –º–∞—Ä–∫–∏—Ä–æ–≤–∫–µ

### 3. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞—Å—á–µ—Ç–∞
- **`payment_method`**: `full_prepayment` ‚Üí `full_payment` (–ø–æ–ª–Ω—ã–π —Ä–∞—Å—á–µ—Ç)
- **`payment_object`**: `service` ‚Üí `job` (—Ä–∞–±–æ—Ç–∞ –¥–ª—è –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å–æ–≤)
- **`cost`**: –¥–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ —Ü–µ–Ω—ã –∑–∞ –µ–¥–∏–Ω–∏—Ü—É —Ç–æ–≤–∞—Ä–∞

### 4. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ
- **–£–±—Ä–∞–Ω–∞ –±–∞–∑–æ–≤–∞—è —É—Å–ª—É–≥–∞** - –≤ —á–µ–∫–µ —Ç–æ–ª—å–∫–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏ –∏ –æ–ø—Ü–∏–∏
- **–¶–µ–Ω–∞ –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å–∞** = —Å—É–º–º–∞ –≤—Å–µ—Ö –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è** - —Å—É–º–º–∞ –ø–æ–∑–∏—Ü–∏–π –¥–æ–ª–∂–Ω–∞ —Ä–∞–≤–Ω—è—Ç—å—Å—è –æ–±—â–µ–π —Å—É–º–º–µ
- **–ì–∏–±–∫–æ–µ —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ** - –∫–∞–∂–¥—ã–π —Ä–æ–¥–∏—Ç–µ–ª—å –ø–ª–∞—Ç–∏—Ç —Ä–∞–∑–Ω—É—é —Å—É–º–º—É

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ URL-–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ Shp-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
**–ë—ã–ª–æ:**
```typescript
const shpParams = {
    Shp_invoice_id: data.invoiceId,
    Shp_participant: encodeURIComponent(data.participantName || '–Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω') // –î–≤–æ–π–Ω–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ
};
```

**–°—Ç–∞–ª–æ:**
```typescript
const shpParams = {
    Shp_invoice_id: data.invoiceId,
    Shp_participant: data.participantName || '–Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω' // –ù–ï –∫–æ–¥–∏—Ä—É–µ–º –∑–¥–µ—Å—å
};

// –ö–æ–¥–∏—Ä—É–µ–º —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–æ–¥–ø–∏—Å–∏
const shpString = sortedShpKeys.map(key => `${key}=${encodeURIComponent(shpParams[key])}`).join(':');

// –í —Ñ–æ—Ä–º–µ –ø–µ—Ä–µ–¥–∞–µ–º –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
Shp_participant: encodeURIComponent(data.participantName || '–Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω')
```

### 3. –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
–î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:
```typescript
console.log('üîç –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∏:', {
    base: signatureBase,
    shpParams: shpParams,
    shpString: shpString,
    finalString: signatureString,
    receiptJson: receiptJson,
    receiptEncoded: receiptEncoded
});
```

## üìã –°–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –†–æ–±–æ–∫–∞—Å—Å—ã

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —á–µ–∫–∞ (Receipt)
```json
{
  "sno": "osn",
  "items": [
    {
      "name": "–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞",
      "quantity": 1,
      "sum": 100,
      "payment_method": "full_prepayment",
      "payment_object": "service",
      "tax": "none"
    }
  ]
}
```

### –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∏
```
MerchantLogin:OutSum:InvId:Receipt:Password1:Shp_–∫–ª—é—á=–∑–Ω–∞—á–µ–Ω–∏–µ
```

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### `backend/src/services/robokassaService.ts`
- **–°—Ç—Ä–æ–∫–∏ 305-347**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —á–µ–∫–∞ (—Å—Ç—Ä–æ—á–Ω—ã–µ –∫–ª—é—á–∏)
- **–°—Ç—Ä–æ–∫–∏ 356-359**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —á–µ–∫–∞
- **–°—Ç—Ä–æ–∫–∏ 375-378**: –£–±—Ä–∞–Ω–æ –¥–≤–æ–π–Ω–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ Shp-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- **–°—Ç—Ä–æ–∫–∏ 380-382**: –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø–æ–¥–ø–∏—Å–∏
- **–°—Ç—Ä–æ–∫–∏ 423-425**: –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —Ñ–æ—Ä–º—ã

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
1. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —á–µ–∫–∞** —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –†–æ–±–æ–∫–∞—Å—Å—ã
2. **URL-–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ** –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ (–Ω–µ—Ç –¥–≤–æ–π–Ω–æ–≥–æ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è)
3. **–ü–æ–¥–ø–∏—Å—å** —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å —É—á–µ—Ç–æ–º –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
4. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç—Å–ª–µ–¥–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤** - —Å–ª–µ–¥–∏—Ç—å –∑–∞ –ª–æ–≥–∞–º–∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–¥–ø–∏—Å–∏
2. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å—á–µ—Ç–∞ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
3. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - –æ–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –†–æ–±–æ–∫–∞—Å—Å–æ–π

---

**–î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** 2025-01-02  
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π:** –ê–ª–µ–∫—Å–µ–π  
**–°—Ç–∞—Ç—É—Å:** –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ
